비지도 학습 

군집 분석 (Clustering Analysis)
비지도 학습 에 속한다 

비지도 학습에 특징 학습에 클래스 레이블이 없는 상태에서 학습을 시작
쉽게 말해서 정답이 존재 하지 않는 데이터를 학습한다고 보면된다,

쇼핑몰에서 제품 탐색  후 
새로운 소비자가 어떤 유형에 속하는지 알수 있는 방법
정답을 모르는 데이터안에서 숨겨진 구조를 찾는 방법

군집 알고리즘 
K - 평균(means)
구현이 매우 쉽고 높은 계산 효율성을 보유하고 있다,
학계난 산업현장에서도 많이 사용하고 있다 
프로토타입 기반 군집

연속적인 특성에서는 비슷한 데이터 포인트의 센트로이드 
				 (centroid - 평균)

범주형 특성에서는 메도이드 (medoid - 가장 자주 등장하는 포인트)

원형 클러스트를 구분하는 거는 뛰어남
사전에 몇개의 클러스터를 만들어야된다는 다소 주관적인 사람의 판단이 개입이됨

이떄 K의 값이 가장 중요한데 K 의 값이 적절하다면 높은 성능을 발휘 하는 알고리즘 이지만
적합하지 않은 K 의 값을 받으면 부적합한 K값을 가짐.

K 평균 알고리즘의 최종 목표는 특성의 유사도에 기초하여 데이터들을 그룹으로 모으는것이다.

k 평균 알고리즘의 수행 단계 (4단계)
1.데이터 포인트에서 랜덤하게 k개의 센트로이드를 초기 클러스터 중심으로 선택 
2.각데이터를 가장 가까운 센트로이드에 할당합니다.
3.할당된 샘플들의 중심으로 센트로이드를 이동시킵니다.
4.클러스터 할당이 변하지 않거나 사용자가 지정한 허용오차나 최대 반복횟수에 도달할때 까지
두번째와 세번째 과정을 반복합니다.

유사도 측정 방식
임의의 차원공간에 있는 두 데이터 포인트 x와 y사이에 
유클리디안 거리,유클리디안 거리 제곱 지표를 사용하여 간단한 최적화 문제로 
k평균 알고리즘을 설명할수 있다 , 

클러스터 내의 제곱 오차합(SSE) 을 반복적으로 최소화 

SSE =  ∑∑ w^(i,j) d(x^(i) ,u^(j)^)^2

u는 임의의 클러스터의 대표 센트로이드 중심 이다 
w값은 측정하려는 데이터와 클러스터에 의해 데이터가 
클러스터 내에 있다면  1아니면 0 의 값을 출력 

유클리디언 거리 제곱 방식에 의해 두번쨰 단계 처럼
센트로이드와 가까운 데이터에 의하여 클러스터의 센트로이드 간 거리를 계산 하여 
이거리는 클러스터의 오차 제곱하게 된다. 
즉 가까운 센트로이드에 할당할때마다 센트로이드가 이동하게 된다.

변화량에 대한 허용 범위 오차값이 일정 수준 내로 들어 온다면 더이상 클러스터가 변화 하지 않는다는 것이고 
최적화 가 완료 되었다는 것이다.

각 점들 간의 거리를 측정할때   점들간의 단위와 변동 폭이 크다면 왜곡이 일어 날수 있다. 

이를 방지 하기 위해 거리 산출시 불필요한 항목산의 특성을 제거하고 단위를 일치시키는 표준화 과정을 진행하면 된다.

kmeans 의 특징 
클러스터가 중첩 x
계층적 x
적어도 하나이상의 데이터 가 있는데
이러한 특징은 큰 리스크 가 있음 
다차원의 데이터가 아니더라도 데이터가 하나의 클러스터로만 
구분되는 법은 없기 때문이다. 

kmeans++ 
초기 센트로이드를 멀리 떨어트리도록 위치 시키는것이다. 

군집을 이루면 올바른 정답인가?
군집 품질을 평가해야 하는 경우  알고리즘 지체의 지표를 사용해야 한다 
클러스터 내의 오차 제곱합을 사용한다. 
sklearn 을 사용해서 구할수 있다. 

km.inertia_ 알고리즘의 왜곡 수치를 확인해볼수 있음 .

엘보우 방법 
왜곡 값을 확인하면서 적절한 k의 값을 찾는 방법을 말한다. 

최적의 클러스터 k개를 추정할수 있다. 
k값의 증가는 센트로이드가 늘어나는것이고 데이터들이 센트로이드에 가까워 지기 때문에 
왜곡값을 줄일수 있다. 

군집 품질을 평가하는 다른 방법은 실루엣 크래프 이다 
클러스터 내 데이터들이 얼마나 조밀하게 모여 있는지를 측정하는 그래프 도구 이다. 

s^(i) = b^(i) - a^(i)/ max{b^(i) , a^(i)}

계수를 구하는 방법 
1. 하나의 임의의 데이터 (x^(i)) 와 동일한 클러스터 내의 모든 다른 데이터 포인트 사이의 
거리를 평균하여 클러스터 응집력(a^(i)) 을 계산 합니다 
2. 앞서 선정한 데이터와 가장 가까운 클러스터의 모든 샘플간 평균 거리로 최근접 클러스터의 클러스터 분리도 C를 계산합니다.
3.클러스터 응집력과 분리도 사이의 차이를 둘중 큰값으로 나눠 실루엣 계수 (S^(i)) 를 계산합니다 

특징 
분리력 b와 응집력 a의 차가 0 이 된다면 실루엣 계수 역시 0 이된다. 
-> 값이 같다는 것이기 때문에 클러스터가 중첩됨을 알수있다.

분리력 이 크다면 이상적인 실루엣 계수 1에 가까워진다 

분리력: 데이터가 다른 클러스터와 얼마나 다른지를 나타내고 
응집력: 클러스터 내의 다른 샘플과 얼마나 비슷한지를 나타내는 것이다. 

이때 응집력은 작을수록 클러스터 내의 데이터가 비슷하다는 뜻이다. 

