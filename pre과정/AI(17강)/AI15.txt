실제 신경망의 손실 함수 식은  = 다차 함수의 꼴이다  
-미분하기 어려운 값들이 많다 

신경망의 목적 
-손실 함수가 최솟값 일 때의 파라미터를 찾아 올바른 학습 결과를 내는것 

이는 회귀 분석이나 로지스틱 회귀와 기본개념이 같다는 걸 알수 있습니다.
차이점은 회귀 분석에서 사용하는 파라미터 개수보다 신경망에서 사용하는 파라미터 수가 훨씬 더 많다.

가중치를 효율적으로 찾고자 다양한 연수를 진행했다..
-> 역전파 알고리즘이 나왔다. 


역전파 알고리즘(backpropagation)
: 뉴런의 가중치를 효율적으로 조정하기 위하여 거꾸로 무엇인가를 전파하는 방식이라고 생각하면 된다.

순전파 & 역전파 
입	은	출	기대출력값
2->	3->	4->	3

1(편향)	1(편향)

가중치 : 1 이라 두고 계산 해보면 
2*1 + 1*1 = 3
3*1 + 1*1 = 4

실제 결과 값 3 ≠ 예측 결과값 4 맞지 않는다 
이를 해결하기 위해 순전파와 역전파 알고리즘을 사용한다.

1. 오차를 찾는다 
현재 실제 결과 값과 예측 출력값의 오차는 1이다.
2.기존의 예측 출력값을 지우고 새로운 출력값 3을 전달한다.
즉 출력층에 4가 3으로 바뀐다고 생각하면 된다.

3.이전의 값에서 은닉층 노드의 3과 편향 값 1 인 중에 당연히 높은 값이 출력층에 영향을 주는 것이다 .
은닉층 의 노드와 고정값을 비교해 값이 큰 값을 더크게 조정해  가중치를 바꿔준다 

은닉층 가중치 가 1이므로 1/10 배 를 조정한다고 예시를 들자 
+은닉층의 노드의 값이 훨씬 크므로 가중치 를 3배 하여 바꿔보도록 하자 

1-0.3 = 0.7  (-0.3)
1-0.1 = 0.9  (-0.1)
이러한 조정을 이뤄내면 은닉층에 전파할 오차값이 0.4 가 빠진 2.6에 가까운수 여야 한다.
 
이러한 과정을 입력층 까지 수행하면 된다. 

이러한 조정을 하면 은닉층은 2.5 출력층은 2.65로 우리가 가중치를 1로 설정할때보다 훨씬 가까운 결과를 예측 할수 있다.

이러한 역전파의 과정은 경사 하강법을 사용하는것 과 똑같다.



손실함수를 정의 해보면 

출력값과 지도데이터(실제값) 에 오차라고 볼수 있다. 

출력값    지도데이터  
z1 z2 	t1 t2 

역전파는 손실 함수가 최솟값일때 가중치로 원래의 가중치를 조정해야 한다
E = 1/2(z1 - t1)^2 + 1/2(z2 - t2) ^2
+특정 입력값에서 손실함수의 최솟값은 의미가 없다. 

모든 입력값을 대상으로 손실함수가 최솟값일때 파라미터를 찾는것이다.

이때 E 의 식은 다음과 같이 정의 할수 있는데 

E = E1+E2+E3+ .... + En 의로 정의 가능 

E가 최솟값일때 가중치를 찾는 식으로 
E를 가중치 W 에 관하여 편미분 하는 식으로 찾는것이가 

aE/aW = aE1/aW + aE2/aW + ... aEn/aW
미분한 값이 0에 가까운 값을 찾아야 한다. 

이때 미분은 기울기와 동일하다 봐도 되므로 0에 가까워 졌을떄 손실함수의 값이 최솟값의 후보가 되기 떄문입니다.

그러나 기울기가 0 이라 해도 이값이 최솟값이라고 단정 지을수는 없다... why?

고차함수의 기울기 변화가 증가 감소 하는 현상의 그래프 여도 있을수 있기 떄문에 

입력값 각각의 손실함수를 편미분 한 후에 합이 0에 가까운지 확인 하는것이 더 간단하다.
손실함수가 최솟값일때의 가중치를 찾아야 하는것이 목적이다.

x    (v)	y    (w) 	z      -> t
1    (a)	1    (b)

z = b+wy 
E = (z - t)^2

aE/aZ = 2(z-t) *1
az/aB = 1
az/aW = y
1.b 로 편미분을 진행해준다.
aE/aB = aE/aZ * az/aB
          = aE/aZ * 1
+ w로 편미분을 진행 

aE/aW = aE/az * az/aW
          = aE/az *y
aE/aW  = aE/aB 와 같기 떄문에 위에 식을 바꿔주면 
           = aE/aB * y 랑 똑같다... 

은닉층에 가중치는 은닉층 편향의 변화량에 y를 곱한 값을 빼서 은닉층 가중치를 조정할수 있다.



은닉층과 입력층 사이도 가중치와 편향을 조정 가능하다.

y = xv + a
aY/aA = 1
a로 편미분 진행 		 
aE/aA = aE/aY * aY/aA   
aE/aA = aE/aY * 1

v로 편미분 진행
aY/aV = x
aE/aV = aE/aY * aY/aV

aE/av = aE/aA * x

입력층에 가중치는 입력층 편향의 변화량에 x를 곱한 값을 빼서 입력층 가중치를 조정할수 있다.


역전파 알고리즘의 문제 : 기울기 소멸 문제가 발생할수 있다.

역전파 알고리즘의 로 자주 사용하는 활성화 함수는 sigmoid 와 softmax 였다.

sigmoid  = 미분의 최대치가 0.3 / 층을 거쳐갈수록 기울기 소멸문제가 발생 
softmax = 출력값으로 부터 확률 백터 를 얻을려 했는데 / 이때 출력 값이 항상 0~1 사이가 나온다.


Relu 함수 
0  (x<=0)
x  (x >0)


